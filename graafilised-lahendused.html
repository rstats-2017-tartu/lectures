<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Reprodutseeritav andmeanalüüs kasutades R keelt</title>
  <meta name="description" content="Praktilise kursuse ‘Reprodutseeritav andmeanalüüs R keeles’ materjalid.">
  <meta name="generator" content="bookdown 0.5.15 and GitBook 2.6.7">

  <meta property="og:title" content="Reprodutseeritav andmeanalüüs kasutades R keelt" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="assets/img/cover.png" />
  <meta property="og:description" content="Praktilise kursuse ‘Reprodutseeritav andmeanalüüs R keeles’ materjalid." />
  <meta name="github-repo" content="rstats-tartu/lectures" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Reprodutseeritav andmeanalüüs kasutades R keelt" />
  
  <meta name="twitter:description" content="Praktilise kursuse ‘Reprodutseeritav andmeanalüüs R keeles’ materjalid." />
  <meta name="twitter:image" content="assets/img/cover.png" />

<meta name="author" content="Taavi Päll, Ülo Maiväli">


<meta name="date" content="2018-01-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="funs.html">
<link rel="next" href="tidyverse.html">
<script src="libs/jquery/jquery.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />








<script src="https://use.fontawesome.com/e4ba4259a1.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Reprodutseeritav andmeanalüüs R programmiga</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Haara kannel, Vanemuine!</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Sissejuhatus</a></li>
<li class="chapter" data-level="2" data-path="tools.html"><a href="tools.html"><i class="fa fa-check"></i><b>2</b> Tarkvaratööriistad</a><ul>
<li class="chapter" data-level="2.1" data-path="tools.html"><a href="tools.html#installeeri-vajalikud-programmid"><i class="fa fa-check"></i><b>2.1</b> Installeeri vajalikud programmid</a></li>
<li class="chapter" data-level="2.2" data-path="tools.html"><a href="tools.html#loo-githubi-konto"><i class="fa fa-check"></i><b>2.2</b> Loo GitHubi konto</a></li>
<li class="chapter" data-level="2.3" data-path="tools.html"><a href="tools.html#loo-uus-r-projekt"><i class="fa fa-check"></i><b>2.3</b> Loo uus R projekt</a></li>
<li class="chapter" data-level="2.4" data-path="tools.html"><a href="tools.html#git-merge-konfliktid"><i class="fa fa-check"></i><b>2.4</b> Git <em>Merge</em> konfliktid</a></li>
<li class="chapter" data-level="2.5" data-path="tools.html"><a href="tools.html#r-projekti-kataloogi-soovitatav-minimaalne-struktuur"><i class="fa fa-check"></i><b>2.5</b> R projekti kataloogi soovitatav minimaalne struktuur</a></li>
<li class="chapter" data-level="2.6" data-path="tools.html"><a href="tools.html#libs"><i class="fa fa-check"></i><b>2.6</b> Pakettide installeerimine</a></li>
<li class="chapter" data-level="2.7" data-path="tools.html"><a href="tools.html#r-repositooriumid"><i class="fa fa-check"></i><b>2.7</b> R repositooriumid</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="calc.html"><a href="calc.html"><i class="fa fa-check"></i><b>3</b> R on kalkulaator</a><ul>
<li class="chapter" data-level="3.1" data-path="calc.html"><a href="calc.html#sama-koodi-saab-kirjutada-neljal-viisil"><i class="fa fa-check"></i><b>3.1</b> Sama koodi saab kirjutada neljal viisil</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="obj.html"><a href="obj.html"><i class="fa fa-check"></i><b>4</b> R objektid</a><ul>
<li class="chapter" data-level="4.1" data-path="obj.html"><a href="obj.html#objekt-ja-nimi"><i class="fa fa-check"></i><b>4.1</b> Objekt ja nimi</a></li>
<li class="chapter" data-level="4.2" data-path="obj.html"><a href="obj.html#nimede-vorm"><i class="fa fa-check"></i><b>4.2</b> Nimede vorm</a></li>
<li class="chapter" data-level="4.3" data-path="obj.html"><a href="obj.html#andmete-tuubid"><i class="fa fa-check"></i><b>4.3</b> Andmete tüübid</a></li>
<li class="chapter" data-level="4.4" data-path="obj.html"><a href="obj.html#vektor"><i class="fa fa-check"></i><b>4.4</b> Vektor</a><ul>
<li class="chapter" data-level="4.4.1" data-path="obj.html"><a href="obj.html#uus-vektor-seq-ja-rep"><i class="fa fa-check"></i><b>4.4.1</b> Uus vektor: <code>seq()</code> ja <code>rep()</code></a></li>
<li class="chapter" data-level="4.4.2" data-path="obj.html"><a href="obj.html#tehted-arvuliste-vektoritega"><i class="fa fa-check"></i><b>4.4.2</b> Tehted arvuliste vektoritega</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="obj.html"><a href="obj.html#list"><i class="fa fa-check"></i><b>4.5</b> List</a></li>
<li class="chapter" data-level="4.6" data-path="obj.html"><a href="obj.html#data-frame-ja-tibble"><i class="fa fa-check"></i><b>4.6</b> data frame ja tibble</a><ul>
<li class="chapter" data-level="4.6.1" data-path="obj.html"><a href="obj.html#rekodeerime-tibble-vaartusi"><i class="fa fa-check"></i><b>4.6.1</b> Rekodeerime tibble väärtusi</a></li>
<li class="chapter" data-level="4.6.2" data-path="obj.html"><a href="obj.html#uhendame-kaks-tibblet-rea-kaupa"><i class="fa fa-check"></i><b>4.6.2</b> Ühendame kaks tibblet rea kaupa</a></li>
<li class="chapter" data-level="4.6.3" data-path="obj.html"><a href="obj.html#uhendame-kaks-tibblet-veeru-kaupa"><i class="fa fa-check"></i><b>4.6.3</b> ühendame kaks tibblet veeru kaupa</a></li>
<li class="chapter" data-level="4.6.4" data-path="obj.html"><a href="obj.html#tabelite-uhendamine-join-ga"><i class="fa fa-check"></i><b>4.6.4</b> tabelite ühendamine join()-ga</a></li>
<li class="chapter" data-level="4.6.5" data-path="obj.html"><a href="obj.html#nii-saab-tibblest-katte-vektori-millega-saab-tehteid-teha."><i class="fa fa-check"></i><b>4.6.5</b> Nii saab tibblest kätte vektori, millega saab tehteid teha.</a></li>
<li class="chapter" data-level="4.6.6" data-path="obj.html"><a href="obj.html#andmeraamide-salvestamine-eksport-import"><i class="fa fa-check"></i><b>4.6.6</b> Andmeraamide salvestamine (eksport-import)</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="obj.html"><a href="obj.html#tabelit-sisse-lugedes-vaata-ule-na-d"><i class="fa fa-check"></i><b>4.7</b> Tabelit sisse lugedes vaata üle NA-d</a></li>
<li class="chapter" data-level="4.8" data-path="obj.html"><a href="obj.html#matrix"><i class="fa fa-check"></i><b>4.8</b> Matrix</a></li>
<li class="chapter" data-level="4.9" data-path="obj.html"><a href="obj.html#indekseerimine"><i class="fa fa-check"></i><b>4.9</b> Indekseerimine</a><ul>
<li class="chapter" data-level="4.9.1" data-path="obj.html"><a href="obj.html#vektorid-ja-nende-indeksid-on-uhedimensionaalsed"><i class="fa fa-check"></i><b>4.9.1</b> Vektorid ja nende indeksid on ühedimensionaalsed</a></li>
<li class="chapter" data-level="4.9.2" data-path="obj.html"><a href="obj.html#andmeraamid-ja-maatriksid-on-kahedimensionaalsed-nagu-ka-nende-indeksid"><i class="fa fa-check"></i><b>4.9.2</b> Andmeraamid ja maatriksid on kahedimensionaalsed, nagu ka nende indeksid</a></li>
<li class="chapter" data-level="4.9.3" data-path="obj.html"><a href="obj.html#listide-indekseerimine"><i class="fa fa-check"></i><b>4.9.3</b> Listide indekseerimine</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regex.html"><a href="regex.html"><i class="fa fa-check"></i><b>5</b> Regular expression ja find &amp; replace</a><ul>
<li class="chapter" data-level="5.1" data-path="regex.html"><a href="regex.html#common-operations-with-regular-expressions"><i class="fa fa-check"></i><b>5.1</b> Common operations with regular expressions</a></li>
<li class="chapter" data-level="5.2" data-path="regex.html"><a href="regex.html#find-and-replace"><i class="fa fa-check"></i><b>5.2</b> Find and replace</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="funs.html"><a href="funs.html"><i class="fa fa-check"></i><b>6</b> Funktsioonid on R keele verbid</a><ul>
<li class="chapter" data-level="6.1" data-path="funs.html"><a href="funs.html#kirjutame-r-funktsiooni"><i class="fa fa-check"></i><b>6.1</b> Kirjutame R funktsiooni</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html"><i class="fa fa-check"></i><b>7</b> Graafilised lahendused</a><ul>
<li class="chapter" data-level="7.1" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#baasgraafika"><i class="fa fa-check"></i><b>7.1</b> Baasgraafika</a></li>
<li class="chapter" data-level="7.2" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#ggplot2"><i class="fa fa-check"></i><b>7.2</b> ggplot2</a></li>
<li class="chapter" data-level="7.3" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#regressioonisirgete-plottimine"><i class="fa fa-check"></i><b>7.3</b> Regressioonisirgete plottimine</a><ul>
<li class="chapter" data-level="7.3.1" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#lisame-plotile-sirgjooni"><i class="fa fa-check"></i><b>7.3.1</b> Lisame plotile sirgjooni</a></li>
<li class="chapter" data-level="7.3.2" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#segmendid-ja-nooled"><i class="fa fa-check"></i><b>7.3.2</b> Segmendid ja nooled</a></li>
<li class="chapter" data-level="7.3.3" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#joongraafikud"><i class="fa fa-check"></i><b>7.3.3</b> Joongraafikud</a></li>
<li class="chapter" data-level="7.3.4" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#punktide-tahistamise-trikid"><i class="fa fa-check"></i><b>7.3.4</b> Punktide tähistamise trikid</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#facet-pisigraafik"><i class="fa fa-check"></i><b>7.4</b> <em>Facet</em> – pisigraafik</a></li>
<li class="chapter" data-level="7.5" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#mitu-graafikut-paneelidena-uhel-joonisel"><i class="fa fa-check"></i><b>7.5</b> Mitu graafikut paneelidena ühel joonisel</a><ul>
<li class="chapter" data-level="7.5.1" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#telgede-ulatus"><i class="fa fa-check"></i><b>7.5.1</b> Telgede ulatus</a></li>
<li class="chapter" data-level="7.5.2" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#log-skaalas-teljed"><i class="fa fa-check"></i><b>7.5.2</b> Log skaalas teljed</a></li>
<li class="chapter" data-level="7.5.3" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#poorame-graafikut-90-kraadi"><i class="fa fa-check"></i><b>7.5.3</b> Pöörame graafikut 90 kraadi</a></li>
<li class="chapter" data-level="7.5.4" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#muudame-telgede-markeeringuid"><i class="fa fa-check"></i><b>7.5.4</b> Muudame telgede markeeringuid</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#telgede-tekst-ja-pealkirjad"><i class="fa fa-check"></i><b>7.6</b> Telgede tekst ja pealkirjad</a><ul>
<li class="chapter" data-level="7.6.1" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#muudame-telgede-ja-legendi-nimed"><i class="fa fa-check"></i><b>7.6.1</b> Muudame telgede ja legendi nimed</a></li>
<li class="chapter" data-level="7.6.2" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#graafiku-pealkiri-alapeakiri-ja-allkiri"><i class="fa fa-check"></i><b>7.6.2</b> Graafiku pealkiri, alapeakiri ja allkiri</a></li>
<li class="chapter" data-level="7.6.3" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#graafiku-legend"><i class="fa fa-check"></i><b>7.6.3</b> Graafiku legend</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#varviskaalad"><i class="fa fa-check"></i><b>7.7</b> Värviskaalad</a><ul>
<li class="chapter" data-level="7.7.1" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#varviskaalad-pidevatele-muutujatele"><i class="fa fa-check"></i><b>7.7.1</b> Värviskaalad pidevatele muutujatele</a></li>
<li class="chapter" data-level="7.7.2" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#varviskaalad-faktormuutujatele"><i class="fa fa-check"></i><b>7.7.2</b> Värviskaalad faktormuutujatele</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#a-complex-ggplot"><i class="fa fa-check"></i><b>7.8</b> A complex ggplot</a></li>
<li class="chapter" data-level="7.9" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#erinevad-ggplot-geom_-id"><i class="fa fa-check"></i><b>7.9</b> Erinevad ggplot geom_-id</a><ul>
<li class="chapter" data-level="7.9.1" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#kui-iga-muutja-kohta-on-uks-andmepunkt"><i class="fa fa-check"></i><b>7.9.1</b> Kui iga muutja kohta on üks andmepunkt</a></li>
<li class="chapter" data-level="7.9.2" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#tulpdiagrammid-moodavad-counte-ja-proportsioone"><i class="fa fa-check"></i><b>7.9.2</b> Tulpdiagrammid mõõdavad counte ja proportsioone</a></li>
<li class="chapter" data-level="7.9.3" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#andmepunktid-on-ukshaaval-valja-plotitud"><i class="fa fa-check"></i><b>7.9.3</b> Andmepunktid on ükshaaval välja plotitud</a></li>
<li class="chapter" data-level="7.9.4" data-path="graafilised-lahendused.html"><a href="graafilised-lahendused.html#kahe-muutuja-koos-varieeruvus"><i class="fa fa-check"></i><b>7.9.4</b> Kahe muutuja koos-varieeruvus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>8</b> Tidyverse</a><ul>
<li class="chapter" data-level="8.1" data-path="tidyverse.html"><a href="tidyverse.html#tidy-tabeli-struktuur"><i class="fa fa-check"></i><b>8.1</b> Tidy tabeli struktuur</a><ul>
<li class="chapter" data-level="8.1.1" data-path="tidyverse.html"><a href="tidyverse.html#tabeli-dimensioonide-muutmine-pikk-ja-lai-formaat"><i class="fa fa-check"></i><b>8.1.1</b> Tabeli dimensioonide muutmine (pikk ja lai formaat)</a></li>
<li class="chapter" data-level="8.1.2" data-path="tidyverse.html"><a href="tidyverse.html#tibble-transpose-read-veergudeks-ja-vastupidi"><i class="fa fa-check"></i><b>8.1.2</b> Tibble transpose — read veergudeks ja vastupidi</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="tidyverse.html"><a href="tidyverse.html#dplyr-ja-selle-viis-verbi"><i class="fa fa-check"></i><b>8.2</b> dplyr ja selle viis verbi</a><ul>
<li class="chapter" data-level="8.2.1" data-path="tidyverse.html"><a href="tidyverse.html#select-columns"><i class="fa fa-check"></i><b>8.2.1</b> <code>select()</code> columns</a></li>
<li class="chapter" data-level="8.2.2" data-path="tidyverse.html"><a href="tidyverse.html#filter-rows"><i class="fa fa-check"></i><b>8.2.2</b> <code>filter()</code> rows</a></li>
<li class="chapter" data-level="8.2.3" data-path="tidyverse.html"><a href="tidyverse.html#summarise"><i class="fa fa-check"></i><b>8.2.3</b> <code>summarise()</code></a></li>
<li class="chapter" data-level="8.2.4" data-path="tidyverse.html"><a href="tidyverse.html#group_by"><i class="fa fa-check"></i><b>8.2.4</b> <code>group_by()</code></a></li>
<li class="chapter" data-level="8.2.5" data-path="tidyverse.html"><a href="tidyverse.html#mutate"><i class="fa fa-check"></i><b>8.2.5</b> <code>mutate()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tidyverse.html"><a href="tidyverse.html#grouped-filters"><i class="fa fa-check"></i><b>8.3</b> Grouped filters</a></li>
<li class="chapter" data-level="8.4" data-path="tidyverse.html"><a href="tidyverse.html#separate-one-column-into-several"><i class="fa fa-check"></i><b>8.4</b> <code>separate()</code> one column into several</a></li>
<li class="chapter" data-level="8.5" data-path="tidyverse.html"><a href="tidyverse.html#faktorid"><i class="fa fa-check"></i><b>8.5</b> Faktorid</a><ul>
<li class="chapter" data-level="8.5.1" data-path="tidyverse.html"><a href="tidyverse.html#tekitame-faktortulba-keerulisemal-teel"><i class="fa fa-check"></i><b>8.5.1</b> tekitame faktortulba keerulisemal teel</a></li>
<li class="chapter" data-level="8.5.2" data-path="tidyverse.html"><a href="tidyverse.html#fct_recode-rekodeerib-faktori-tasemed"><i class="fa fa-check"></i><b>8.5.2</b> <code>fct_recode()</code> rekodeerib faktori tasemed</a></li>
<li class="chapter" data-level="8.5.3" data-path="tidyverse.html"><a href="tidyverse.html#fct_collapse-annab-argumenti-sisse-vanade-tasemete-vektori-et-teha-vahem-uusi-tasemeid."><i class="fa fa-check"></i><b>8.5.3</b> <code>fct_collapse()</code> annab argumenti sisse vanade tasemete vektori, et teha vähem uusi tasemeid.</a></li>
<li class="chapter" data-level="8.5.4" data-path="tidyverse.html"><a href="tidyverse.html#fct_lump-loob-kokku-koik-vahem-arv-kordi-esinevad-tasemed."><i class="fa fa-check"></i><b>8.5.4</b> <code>fct_lump()</code> lööb kokku kõik vähem arv kordi esinevad tasemed.</a></li>
<li class="chapter" data-level="8.5.5" data-path="tidyverse.html"><a href="tidyverse.html#rekodeerime-pideva-muutuja-faktoriks"><i class="fa fa-check"></i><b>8.5.5</b> Rekodeerime pideva muutuja faktoriks</a></li>
<li class="chapter" data-level="8.5.6" data-path="tidyverse.html"><a href="tidyverse.html#muudame-faktori-tasemete-jarjekorda-joonisel"><i class="fa fa-check"></i><b>8.5.6</b> Muudame faktori tasemete järjekorda joonisel</a></li>
<li class="chapter" data-level="8.5.7" data-path="tidyverse.html"><a href="tidyverse.html#fct_relevel-tostab-joonisel-osad-tasemed-teistest-ettepoole"><i class="fa fa-check"></i><b>8.5.7</b> <code>fct_relevel()</code> tõstab joonisel osad tasemed teistest ettepoole</a></li>
<li class="chapter" data-level="8.5.8" data-path="tidyverse.html"><a href="tidyverse.html#joontega-plotil-saab-fct_reorder2-abil-assotseerida-y-vaartused-suurimate-x-vaartustega"><i class="fa fa-check"></i><b>8.5.8</b> Joontega plotil saab <code>fct_reorder2()</code> abil assotseerida y väärtused suurimate x väärtustega</a></li>
<li class="chapter" data-level="8.5.9" data-path="tidyverse.html"><a href="tidyverse.html#tulpdiagrammide-korral-kasuta-fct_infreq"><i class="fa fa-check"></i><b>8.5.9</b> Tulpdiagrammide korral kasuta <code>fct_infreq()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html"><i class="fa fa-check"></i><b>9</b> Statistilised mudelid</a><ul>
<li class="chapter" data-level="9.1" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#suur-ja-vaike-maailm"><i class="fa fa-check"></i><b>9.1</b> Suur ja väike maailm</a></li>
<li class="chapter" data-level="9.2" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#mudeli-vaike-maailm"><i class="fa fa-check"></i><b>9.2</b> Mudeli väike maailm</a><ul>
<li class="chapter" data-level="9.2.1" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#naide-aristoteles-ptolemaios-ja-kopernikus"><i class="fa fa-check"></i><b>9.2.1</b> Näide: Aristoteles, Ptolemaios ja Kopernikus</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#lineaarsed-mudelid"><i class="fa fa-check"></i><b>9.3</b> Lineaarsed mudelid</a><ul>
<li class="chapter" data-level="9.3.1" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#neli-moistet"><i class="fa fa-check"></i><b>9.3.1</b> Neli mõistet</a></li>
<li class="chapter" data-level="9.3.2" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#mudeli-fittimine"><i class="fa fa-check"></i><b>9.3.2</b> Mudeli fittimine</a></li>
<li class="chapter" data-level="9.3.3" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#kaks-lineaarse-mudeli-laiendust."><i class="fa fa-check"></i><b>9.3.3</b> kaks lineaarse mudeli laiendust.</a></li>
<li class="chapter" data-level="9.3.4" data-path="statistilised-mudelid.html"><a href="statistilised-mudelid.html#interaktsioonimudel---uhe-prediktori-moju-soltub-teise-prediktori-vaartusest"><i class="fa fa-check"></i><b>9.3.4</b> Interaktsioonimudel - ühe prediktori mõju sõltub teise prediktori väärtusest</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="bibliograafia.html"><a href="bibliograafia.html"><i class="fa fa-check"></i>Bibliograafia</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstats-tartu/lectures" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Reprodutseeritav andmeanalüüs kasutades R keelt</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="graafilised-lahendused" class="section level1">
<h1><span class="header-section-number">7</span> Graafilised lahendused</h1>
<p>R-s on kaks olulisemat graafikasüsteemi mida võib vaadata nagu kaht eraldi keelt mis mõlemad elavad R keele sees.</p>
<ul>
<li><strong>Baasgraafika</strong> võimaldab väga lihtsate vahenditega teha kiireid ja suhteliselt ilusaid graafikuid. Seda kasutame sageli enda tarbeks kiirete plottide tegemiseks. Baasgraafika abil saab teha ka väga keerukaid ja kompleksseid publitseerimiskavaliteedis graafikuid.</li>
<li><strong>“ggplot2”</strong> raamatukogu on hea ilupiltide vormistamiseks ja keskmiselt keeruliste visualiseeringute tegemiseks.</li>
</ul>
<p>Kuigi “ggplot2” ja tema sateliit-raamatukogud on meie põhilised huviobjekid, alustame siiski baasgraafikast. Ehki me piirdume vaid väga lihtsate näidetega tasub teada, et baasgraafikas saab teha ka komplekseid visualiseeringuid: <a href="http://shinyapps.org/apps/RGraphCompendium/index.php" class="uri">http://shinyapps.org/apps/RGraphCompendium/index.php</a></p>
<p>Laadime peatükis edaspidi vajalikud libraryd:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(ggrepel)
<span class="kw">library</span>(ggjoy)</code></pre></div>
<pre><code>## Loading required package: ggridges</code></pre>
<pre><code>## The ggjoy package has been deprecated. Please
## switch over to the ggridges package, which
## provides the same functionality. Porting
## guidelines can be found here:
## https://github.com/clauswilke/ggjoy/blob/master/README.md</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(wesanderson)</code></pre></div>
<div id="baasgraafika" class="section level2">
<h2><span class="header-section-number">7.1</span> Baasgraafika</h2>
<p>Kõigepealt laadime tabeli, mida me visuaalselt analüüsima hakkame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(iris)
iris</code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.… Spec…
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;
##  1         5.10        3.50         1.40   0.200 seto…
##  2         4.90        3.00         1.40   0.200 seto…
##  3         4.70        3.20         1.30   0.200 seto…
##  4         4.60        3.10         1.50   0.200 seto…
##  5         5.00        3.60         1.40   0.200 seto…
##  6         5.40        3.90         1.70   0.400 seto…
##  7         4.60        3.40         1.40   0.300 seto…
##  8         5.00        3.40         1.50   0.200 seto…
##  9         4.40        2.90         1.40   0.200 seto…
## 10         4.90        3.10         1.50   0.100 seto…
## # ... with 140 more rows</code></pre>
<p>See sisaldab mõõtmistulemusi sentimeetrites kolme iirise perekonna liigi kohta. Esimest korda avaldati need andmed 1936. aastal R.A. Fisheri poolt.</p>
<p>Baasgraafika põhiverb on <code>plot()</code>. See püüab teie poolt ette antud andmete pealt ära arvata, millist graafikut te soovite. <code>plot()</code> põhiargumendid on x ja y, mis määravad selle, mis väärtused asetatakse x-teljele ja mis läheb y-teljele. Esimene argument on vaikimisi x ja teine y.</p>
<p>Kui te annate ette faktorandmed, on vastuseks tulpdiagramm, kus tulbad loevad üles selle faktori kõigi tasemete esinemiste arvu. Antud juhul on meil igast liigist mõõdetud 50 isendit.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Species)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-108-1.pdf" width="672" type="application/pdf" />
<p>Kui te annate ette ühe pideva muutuja:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-109-1.pdf" width="672" type="application/pdf" />
<p>Nüüd on tulemuseks graafik, kus on näha mõõtmisete rea (ehk tabeli) iga järgmise liikme (tabeli rea) väärtus. Siin on meil kokku 150 mõõtmist muutujale <code>Sepal.Length</code>.</p>
<p>Alternatiiv sellele vaatele on <code>stripchart()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stripchart</span>(iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-110-1.pdf" width="672" type="application/pdf" />
<p>Enam lihtsamaks üks joonis ei lähe!</p>
<p>Mis juhtub, kui me x-teljele paneme faktortunnuse ja y-teljele pideva tunnuse?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Species, iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-111-1.pdf" width="672" type="application/pdf" />
<p>Vastuseks on boxplot. Sama graafiku saame ka nii:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">boxplot</span>(iris<span class="op">$</span>Sepal.Length <span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Species).</code></pre></div>
<p>Siin on tegu R-i mudeli notatsiooniga: y-telje muutuja, tilde, x-telje muutuja. Tilde näitab, et y sõltub x-st stohhastiliselt, mitte deterministlikult. Deterministliku seost tähistatakse võrdusmärgiga (=).</p>
<p>Aga vastupidi?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Species)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-113-1.pdf" width="672" type="application/pdf" />
<p>Pole paha, see on üsna informatiivne scatterplot.</p>
<p>Järgmiseks kahe pideva muutuja scatterplot, kus me veel lisaks värvime punktid liikide järgi.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Sepal.Width, <span class="dt">col =</span> iris<span class="op">$</span>Species)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-114-1.pdf" width="672" type="application/pdf" />
<p>Ja lõpuks tõmbame läbi punktide punase regressioonijoone:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris<span class="op">$</span>Sepal.Length, iris<span class="op">$</span>Sepal.Width)
model &lt;-<span class="st"> </span><span class="kw">lm</span>(iris<span class="op">$</span>Sepal.Width <span class="op">~</span><span class="st"> </span>iris<span class="op">$</span>Sepal.Length)
<span class="kw">abline</span>(model, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-115-1.pdf" width="672" type="application/pdf" />
<p>“lwd” parameeter reguleerib joone laiust. <code>lm()</code> on funktsioon, mis fitib sirge vähimruutude meetodil.</p>
<p>Mis juhtub, kui me anname <code>plot()</code> funktsioonile sisse kogu irise tibble?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(iris, <span class="dt">col =</span> iris<span class="op">$</span>Species)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-116-1.pdf" width="672" type="application/pdf" />
<p>Juhhei, tulemus on paariviisiline graafik kõigist muutujate kombinatsioonidest.</p>
<p>Ainus mitte-plot verb, mida baasgraafikas vajame, on <code>hist()</code>, mis joonistab histogrammi.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-117-1.pdf" width="672" type="application/pdf" />
<p>Histogrammi tegemiseks jagatakse andmepunktid nende väärtuste järgi bin-idesse ja plotitakse igasse bin-i sattunud andmepunktide arv. Näiteks esimeses bin-is on “Sepal.Length” muutuja väärtused, mis jäävad 4 ja 4.5 cm vahele ja selliseid väärtusi on kokku viis. Histogrammi puhul on oluline teada, et selle kuju sõltub bin-ide laiusest. Bini laiust saab muuta kahel viisil, andes ette bin-ide piirid või arvu:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(iris<span class="op">$</span>Sepal.Length, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">4</span>, <span class="dv">9</span>, <span class="dt">by =</span> <span class="fl">0.25</span>))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-118-1.pdf" width="672" type="application/pdf" />
<p>või</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(iris<span class="op">$</span>Sepal.Length, <span class="dt">breaks =</span> <span class="dv">15</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-119-1.pdf" width="672" type="application/pdf" />
<p>See viimane on kiire viis bin-i laiust reguleerida, aga arvestage, et sõltuvalt andmetest ei pruugi “breaks = 15” tähendada, et teie histogrammil on 15 bin-i.</p>
<p>Ja lõpuks veel üks histogramm, et demonstreerida baas R-i võimalusi (samad argumendid töötavad ka <code>plot()</code> funktsioonis):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(iris<span class="op">$</span>Sepal.Length,
     <span class="dt">freq =</span> <span class="ot">FALSE</span>, 
     <span class="dt">col=</span><span class="st">&quot;red&quot;</span>,
     <span class="dt">breaks =</span> <span class="dv">15</span>,
     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">9</span>), 
     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), 
     <span class="dt">main =</span> <span class="st">&quot;Iris&quot;</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;Sepal length&quot;</span>,
     <span class="dt">ylab =</span> <span class="st">&quot;Probability density&quot;</span>)

<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(iris<span class="op">$</span>Sepal.Length), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>) 
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">0.3</span>, <span class="dt">col =</span> <span class="st">&quot;cyan&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-120-1.pdf" width="672" type="application/pdf" />
</div>
<div id="ggplot2" class="section level2">
<h2><span class="header-section-number">7.2</span> ggplot2</h2>
<p>Ggplot on avaldamiseks sobiva tasemega lihtne aga võimas graafikasüsteem. Näiteid selle abil tehtud visualiseeringutest leiab näiteks järgnevatelt linkidelt:</p>
<ul>
<li><a href="http://ggplot2.tidyverse.org/reference/" class="uri">http://ggplot2.tidyverse.org/reference/</a></li>
<li><a href="http://www.r-graph-gallery.com" class="uri">http://www.r-graph-gallery.com</a></li>
<li><a href="http://www.ggplot2-exts.org" class="uri">http://www.ggplot2-exts.org</a></li>
<li><a href="http://www.cookbook-r.com" class="uri">http://www.cookbook-r.com</a></li>
</ul>
<p>“ggplot2” paketi põhiverb on <code>ggplot()</code>. See graafikasüsteem töötab kiht-kihi-haaval ja uusi kihte lisatakse pluss-märgi abil. See annab modulaarsuse kaudu lihtsuse ja võimaluse luua ka keerulisi taieseid. Tõenäoliselt on ggplot hetkel kättesaadavatest graafikasüsteemidest parim (kaasa arvates tasulised programmid!).</p>
<p>ggploti töövoog on järgmine, minimaalselt pead ette andma kolm asja:</p>
<ol style="list-style-type: decimal">
<li><p><strong>andmed</strong>, mida visualiseeritakse,</p></li>
<li><p><code>aes()</code> funktsiooni, mis määrab, milline muutuja läheb x-teljele ja milline y-teljele, ning</p></li>
<li><p><strong>geom</strong>, mis määrab, mis tüüpi visualiseeringut sa tahad.</p></li>
</ol>
<p>Lisaks määrad sa <code>aes()</code>-is, kas ja kuidas sa tahad grupeerida pidevaid muutujaid faktori tasemete järgi.</p>
<p>Kõigepealt suuname oma andmed <code>ggplot()</code> funktsiooni:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-121-1.pdf" width="672" type="application/pdf" />
<p>Saime tühja ploti. Erinevalt baasgraafikast, ggplot-i puhul ainult andmetest ei piisa, et graafik valmis joonistataks. Vaja on lisada kiht-kihilt instruktsioonid, kuidas andmed graafikule paigutada ja missugust graafikutüüpi visualiseerimiseks kasutada.</p>
<p>Nüüd ütleme, et x-teljele pannakse “Sepal.Length” ja y-teljele “Sepal.Width” andmed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-122-1.pdf" width="672" type="application/pdf" />
<p>Aga graafik on ikka tühi sest me pole ggplotile öelnud, millist visualiseeringut me tahame. Teeme seda nüüd.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-123-1.pdf" width="672" type="application/pdf" />
<p>Me lisasime kaks kihti: esimene kiht <code>geom_point()</code> visualiseerib andmepunktid ja teine <code>geom_smooth(method = &quot;lm&quot;)</code> joonistab regressioonisirge koos usaldusintervalliga (standardviga).</p>
<blockquote>
<p>Plussmärk peab ggplot-i koodireas olema vana rea lõpus, mitte uue rea (kihi) alguses</p>
</blockquote>
</div>
<div id="regressioonisirgete-plottimine" class="section level2">
<h2><span class="header-section-number">7.3</span> Regressioonisirgete plottimine</h2>
<p>Järgmiseks värvime eelnevalt tehtud plotil punktid iirise liigi kaupa aga joonistame ikkagi regressioonisirge läbi kõikide punktide. Vaata mis juhtub, kui värvide lahutamine toimub <code>ggplot()</code>-i enda <code>aes()</code>-s. <code>theme_classic()</code> muudab graafiku üldist väljanägemist.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-124-1.pdf" width="672" type="application/pdf" />
<p>Me võime <code>geom_smooth()</code>-i anda erineva andmeseti kui <code>ggplot()</code> põhifunktsiooni. Nii joonistame me regressioonisirge ainult nendele andmetele. Proovi ka <code>theme_bw()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> <span class="kw">filter</span>(iris, Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>), <span class="dt">method =</span> lm) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-125-1.pdf" width="672" type="application/pdf" />
<p>Alljärgnevalt näiteks moodus kuidas öelda, et me soovime regressioonijoont näidata ainult iiriseliikide virginica või versicolor andmetele.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## First we filter only data that we want to use for regressionline
smooth_data &lt;-<span class="st"> </span><span class="kw">filter</span>(iris, Species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;virginica&quot;</span>, <span class="st">&quot;versicolor&quot;</span>))
## Then we use this filtered dataset in geom_smooth
<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">data =</span> smooth_data, <span class="dt">method =</span> lm)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-126-1.pdf" width="672" type="application/pdf" />
<p>Ja lõpuks joonistame kolm regressioonisirget – üks igale liigile.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">color =</span> Species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-127-1.pdf" width="672" type="application/pdf" />
<p><strong>Nüüd üks näide teiste andmetega.</strong> Kaalutud lineaarne mudel on viis anda andmepunktidele, mida me tähtsamaks peame (või mis on täpsemalt mõõdetud) suurem kaal. Kõigepealt, siin on USA demograafilised andmed <code>midwest</code> “ggplot2” library-st erinevate kesk-lääne omavalitsuste kohta (437 omavalitsust).</p>
<p>Me valime <code>midwest</code> andmetest välja kolm muutujat: “percwhite”, “percbelowpoverty”, “poptotal”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">midwest_subset &lt;-<span class="st"> </span>midwest <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(percwhite, percbelowpoverty, poptotal)
midwest_subset</code></pre></div>
<pre><code>## # A tibble: 437 x 3
##    percwhite percbelowpoverty poptotal
##        &lt;dbl&gt;            &lt;dbl&gt;    &lt;int&gt;
##  1      96.7            13.2     66090
##  2      66.4            32.2     10626
##  3      96.6            12.1     14991
##  4      95.3             7.21    30806
##  5      90.2            13.5      5836
##  6      98.5            10.4     35688
##  7      99.5            15.1      5322
##  8      98.3            11.7     16805
##  9      99.6            13.9     13437
## 10      84.7            15.6    173025
## # ... with 427 more rows</code></pre>
<p>Me tahame teada, kuidas valge rassi osakaal ennustab vaesust, aga me arvame, et suurematel omavalitsustel peaks selles ennustuses olema suurem kaal kui väiksematel. Selleks lisame <code>geom_smooth()</code>-i lisaargumendi “weight”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(midwest_subset, <span class="kw">aes</span>(percwhite, percbelowpoverty)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> poptotal)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">weight =</span> poptotal), <span class="dt">method =</span> lm, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Percent white&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Percent below poverty&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-129-1.pdf" width="672" type="application/pdf" />
<p>Punane on kaalumata regressioonisirge ja sinine on populatsioonisuuruse suhtes kaalutud regressioonisirge. Kaalumine mitte ainult ei muutnud sirge asukohta vaid vähendas ka ebakindlust sirge asukoha kohta.</p>
<p>Regeressioonijoone saab ggplotil määrata ka x-telje lõikumispunkti ja tõusu abil. See on kasulik mudelite visualiseerimisel mudeli koefitsientide põhjal. Kasuta <code>geom_abline()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Create plot
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mtcars, <span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> mpg)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()
## Fit model and extract coefficients
model &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars)
coefs  &lt;-<span class="st"> </span><span class="kw">coef</span>(model)
## Add regressionline to the plot
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> coefs[<span class="dv">1</span>], 
                 <span class="dt">slope =</span> coefs[<span class="dv">2</span>], 
                 <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, 
                 <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, 
                 <span class="dt">size =</span> <span class="fl">1.5</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-130-1.pdf" width="672" type="application/pdf" />
<div id="lisame-plotile-sirgjooni" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Lisame plotile sirgjooni</h3>
<p>Horisontaalsed sirged saab graafikule lisada <code>geom_hline()</code> abil. Pane tähele, et eelnevalt me andsime oma ggplot-i põhikihtidele nime “p” ja seega panime selle alusploti oma töökeskkonda, et saaksime seda korduvkasutada.</p>
<p>Lisame graafikule horisontaaljoone y = 20:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add horizontal line at y = 2O</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">20</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-131-1.pdf" width="672" type="application/pdf" />
<p>Vertikaalseid sirgeid saab lisada <code>geom_vline()</code> abil, näiteks vertikaalne sirge asukohas x = 3:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add a vertical line at x = 3</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">3</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-132-1.pdf" width="672" type="application/pdf" />
</div>
<div id="segmendid-ja-nooled" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Segmendid ja nooled</h3>
<p>“ggplot2” funktsioon <code>geom_segment()</code> lisab joonejupi, mille algus ja lõpp on ette antud.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add a vertical line segment</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">xend =</span> <span class="dv">4</span>, <span class="dt">yend =</span> <span class="dv">27</span>))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-133-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Add horizontal line segment</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">15</span>, <span class="dt">xend =</span> <span class="dv">3</span>, <span class="dt">yend =</span> <span class="dv">15</span>))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-133-2.pdf" width="672" type="application/pdf" />
<p>Saab joonistada ka <strong>nooli</strong>, kasutades arumenti “arrow” funktsioonis <code>geom_segment()</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">30</span>, <span class="dt">xend =</span> <span class="fl">3.5</span>, <span class="dt">yend =</span> <span class="dv">25</span>),
                 <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(<span class="fl">0.5</span>, <span class="st">&quot;cm&quot;</span>)))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-134-1.pdf" width="672" type="application/pdf" />
</div>
<div id="joongraafikud" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Joongraafikud</h3>
<p>“ggplot2”-s on näiteks joonetüübid on “blank”, “solid”, “dashed”, “dotted”, “dotdash”, “longdash”, “twodash”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meals &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sex =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;Female&quot;</span>, <span class="st">&quot;Male&quot;</span>), <span class="dt">each =</span> <span class="dv">3</span>),
                  <span class="dt">time =</span> <span class="kw">c</span>(<span class="st">&quot;breakfeast&quot;</span>, <span class="st">&quot;Lunch&quot;</span>, <span class="st">&quot;Dinner&quot;</span>),
                  <span class="dt">bill =</span> <span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">15</span>, <span class="dv">13</span>, <span class="dv">40</span>, <span class="dv">17</span>) )

<span class="co"># Change line colors and sizes</span>
<span class="kw">ggplot</span>(<span class="dt">data =</span> meals, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> bill, <span class="dt">group =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-135-1.pdf" width="672" type="application/pdf" />
<p>Järgneval graafikul muudame joonetüüpi automaatselt muutuja sex taseme järgi:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Change line types + colors</span>
<span class="kw">ggplot</span>(meals, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> bill, <span class="dt">group =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> sex, <span class="dt">color =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-136-1.pdf" width="672" type="application/pdf" />
<p>Muuda jooni käsitsi:</p>
<ul>
<li><p><code>scale_linetype_manual()</code>: joone tüüp</p></li>
<li><p><code>scale_color_manual()</code>: joone värv</p></li>
<li><p><code>scale_size_manual()</code>: joone laius</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(meals, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> bill, <span class="dt">group =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> sex, <span class="dt">color =</span> sex, <span class="dt">size =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;twodash&quot;</span>, <span class="st">&quot;dotted&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&#39;#999999&#39;</span>, <span class="st">&#39;#E69F00&#39;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_size_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-137-1.pdf" width="672" type="application/pdf" />
</div>
<div id="punktide-tahistamise-trikid" class="section level3">
<h3><span class="header-section-number">7.3.4</span> Punktide tähistamise trikid</h3>
<p><code>aes()</code> töötab nii <code>ggplot()</code> kui <code>geom_</code> funktsioonides.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">size =</span> Petal.Length, <span class="dt">color =</span> Species))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-138-1.pdf" width="672" type="application/pdf" />
<p>Kui me kasutame color argumenti <code>aes()</code>-st väljaspool, siis värvime kõik punktid sama värvi.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Length, <span class="dt">y =</span> Sepal.Width, <span class="dt">size =</span> Petal.Length), <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-139-1.pdf" width="672" type="application/pdf" />
<p>Kasulik trikk on kasutada mitut andmesetti sama ploti tegemiseks. Uus andmestik – “mpg” – on autode kütusekulu kohta.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mpg, <span class="dv">2</span>)</code></pre></div>
<pre><code>## # A tibble: 2 x 11
##   manufac… model displ  year   cyl trans   drv     cty
##   &lt;chr&gt;    &lt;chr&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt; &lt;int&gt;
## 1 audi     a4     1.80  1999     4 auto(l… f        18
## 2 audi     a4     1.80  1999     4 manual… f        21
## # ... with 3 more variables: hwy &lt;int&gt;, fl &lt;chr&gt;,
## #   class &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">best_in_class &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(class) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">top_n</span>(<span class="dv">1</span>, hwy)

<span class="kw">head</span>(best_in_class)</code></pre></div>
<pre><code>## # A tibble: 6 x 11
## # Groups:   class [2]
##   manufa… model   displ  year   cyl trans  drv     cty
##   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt;
## 1 chevro… corvet…  5.70  1999     8 manua… r        16
## 2 chevro… corvet…  6.20  2008     8 manua… r        16
## 3 dodge   carava…  2.40  1999     4 auto(… f        18
## 4 dodge   carava…  3.00  1999     6 auto(… f        17
## 5 dodge   carava…  3.30  2008     6 auto(… f        17
## 6 dodge   carava…  3.30  2008     6 auto(… f        17
## # ... with 3 more variables: hwy &lt;int&gt;, fl &lt;chr&gt;,
## #   class &lt;chr&gt;</code></pre>
<p>Siin läheb kitsam andmeset uude <code>geom_point()</code> kihti ja teeb osad punktid teistsuguseks. Need on oma klassi parimad autod.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> class))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">data =</span> best_in_class) </code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-141-1.pdf" width="672" type="application/pdf" />
<p>Lõpuks toome graafikul eraldi välja nende parimate autode mudelite nimed. Selleks kasutame “ggrepel” raamatukogu funktsiooni <code>geom_label_repel()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> class))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">data =</span> best_in_class) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_label_repel</span>(<span class="kw">aes</span>(<span class="dt">label =</span> model), <span class="dt">data =</span> best_in_class, <span class="dt">cex =</span> <span class="dv">2</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-142-1.pdf" width="672" type="application/pdf" />
</div>
</div>
<div id="facet-pisigraafik" class="section level2">
<h2><span class="header-section-number">7.4</span> <em>Facet</em> – pisigraafik</h2>
<p>Kui teil on mitmeid muutujaid või nende alamhulki, on teil kaks võimalust.</p>
<ol style="list-style-type: decimal">
<li><p>grupeeri pidevad muutujad faktormuutujate tasemete järgi ja kasuta color, fill, shape, size alpha parameetreid, et erinevatel gruppidel vahet teha.</p></li>
<li><p>grupeeri samamoodi ja kasuta facet-it, et iga grupp omaenda paneelile panna.</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#here we separate different classes of cars into different colors</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) 
p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> class))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-143-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>class)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-144-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>class, <span class="dt">nrow =</span> <span class="dv">2</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-145-1.pdf" width="672" type="application/pdf" />
<p>Kui me tahame kahe muutuja kõigi kombinatsioonide vastu paneele, siis kasuta <code>facet_grid()</code> funktsiooni.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>cyl)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-146-1.pdf" width="672" type="application/pdf" />
<ul>
<li>“drv” – drive - 4(-wheel), f(orward), r(ear).</li>
<li>“cyl” – cylinders - 4, 5, 6, or 8.</li>
</ul>
<p>Kasutades punkti <code>.</code> on võimalik asetada kõik alamgraafikud kõrvuti <code>(. ~ var)</code> või üksteise peale <code>(var ~ .)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>drv)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-147-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(drv <span class="op">~</span><span class="st"> </span>.)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-148-1.pdf" width="672" type="application/pdf" />
</div>
<div id="mitu-graafikut-paneelidena-uhel-joonisel" class="section level2">
<h2><span class="header-section-number">7.5</span> Mitu graafikut paneelidena ühel joonisel</h2>
<p>Kõigepealt tooda komponentgraafikud ggplot() abil ja tee nendest graafilised objektid. Näiteks nii:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
i1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span> iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>()
i2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span> iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>()</code></pre></div>
<p>Seejäral, kasuta funktsioon <code>gridExtra::grid.arrange()</code> et graafikud kõrvuti panna</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gridExtra)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(i2, i1, <span class="dt">nrow =</span> <span class="dv">1</span>) <span class="co"># ncol = 2 also works</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value
## with `binwidth`.</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-150-1.pdf" width="672" type="application/pdf" />
<div id="telgede-ulatus" class="section level3">
<h3><span class="header-section-number">7.5.1</span> Telgede ulatus</h3>
<p>Telgede ulatust saab määrata kolmel erineval viisil</p>
<ol style="list-style-type: decimal">
<li><p>filtreeri andmeid, mida plotid</p></li>
<li><p>pane x- ja y-teljele piirangud <code>xlim()</code>, <code>ylim()</code></p></li>
<li><p>kasuta <code>coord_cartesian()</code> ja xlim, ylim on parameetrid selle sees: <code>coord_cartesian(xlim = c(5, 7), ylim = c(10, 30))</code></p></li>
</ol>
<p>Telgede ulatust saab muuta ka x- ja y-teljele eraldi:</p>
<ul>
<li><code>scale_x_continuous(limits = range(mpg$displ))</code></li>
<li><code>scale_y_continuous(limits = range(mpg$hwy))</code></li>
</ul>
</div>
<div id="log-skaalas-teljed" class="section level3">
<h3><span class="header-section-number">7.5.2</span> Log skaalas teljed</h3>
<ol style="list-style-type: decimal">
<li>Lineaarsed andmed lineaarsetel telgedel.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cars, <span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lineaarsed andmed ja teljed&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-151-1.pdf" width="672" type="application/pdf" />
<ol start="2" style="list-style-type: decimal">
<li>Logaritmi andmed <code>aes()</code>-s.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cars, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log2</span>(speed), <span class="dt">y =</span> <span class="kw">log2</span>(dist))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Andmed ja teljed on logaritmitud&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-152-1.pdf" width="672" type="application/pdf" />
<ol start="3" style="list-style-type: decimal">
<li>Andmed on logaritmitud, aga teljed mitte.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(cars, <span class="kw">aes</span>(<span class="dt">x =</span> speed, <span class="dt">y =</span> dist)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_trans</span>(<span class="dt">x =</span> <span class="st">&quot;log2&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;log2&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Andmed on logaritmitud, aga teljed mitte&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-153-1.pdf" width="672" type="application/pdf" />
</div>
<div id="poorame-graafikut-90-kraadi" class="section level3">
<h3><span class="header-section-number">7.5.3</span> Pöörame graafikut 90 kraadi</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Species, <span class="dt">y =</span> Sepal.Length)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-154-1.pdf" width="672" type="application/pdf" />
</div>
<div id="muudame-telgede-markeeringuid" class="section level3">
<h3><span class="header-section-number">7.5.4</span> Muudame telgede markeeringuid</h3>
<p>Muudame y-telje markeeringut:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">15</span>, <span class="dv">40</span>, <span class="dt">by =</span> <span class="dv">5</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;y-telje markeeringud</span><span class="ch">\n</span><span class="st">15 kuni 40, viieste vahedega&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-155-1.pdf" width="672" type="application/pdf" />
<p>Muudame x-telje markeeringute nurka muutes <code>theme()</code> funktsiooni argumenti “axis.text.x”:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-156-1.pdf" width="672" type="application/pdf" />
<p>Eemaldame telgede markeeringud, ka läbi <code>theme()</code> funktsiooni:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_blank</span>())</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-157-1.pdf" width="672" type="application/pdf" />
</div>
</div>
<div id="telgede-tekst-ja-pealkirjad" class="section level2">
<h2><span class="header-section-number">7.6</span> Telgede tekst ja pealkirjad</h2>
<div id="muudame-telgede-ja-legendi-nimed" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Muudame telgede ja legendi nimed</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length, Sepal.Width, <span class="dt">color =</span> Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>()
p <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(
     <span class="dt">x =</span> <span class="st">&quot;Length&quot;</span>,
     <span class="dt">y =</span> <span class="st">&quot;Width&quot;</span>,
     <span class="dt">color =</span> <span class="st">&quot;Iris sp.&quot;</span>
     )</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-158-1.pdf" width="672" type="application/pdf" />
<p>Eemaldame telgede nimed:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_blank</span>())</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-159-1.pdf" width="672" type="application/pdf" />
</div>
<div id="graafiku-pealkiri-alapeakiri-ja-allkiri" class="section level3">
<h3><span class="header-section-number">7.6.2</span> Graafiku pealkiri, alapeakiri ja allkiri</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length, Sepal.Width, <span class="dt">color =</span> Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(
     <span class="dt">title =</span> <span class="st">&quot;Main Title&quot;</span>,
     <span class="dt">subtitle =</span> <span class="st">&quot;Subtitle&quot;</span>,
     <span class="dt">caption =</span> <span class="st">&quot;Figure caption&quot;</span>
      )</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-160-1.pdf" width="672" type="application/pdf" />
<p><code>ggtitle()</code> annab graafikule pealkirja</p>
</div>
<div id="graafiku-legend" class="section level3">
<h3><span class="header-section-number">7.6.3</span> Graafiku legend</h3>
<p>Legend erinevalt graafikust endast ei ole pool-läbipaistev.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">norm &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">1000</span>), <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">1000</span>))
norm<span class="op">$</span>z &lt;-<span class="st"> </span><span class="kw">cut</span>(norm<span class="op">$</span>x, <span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">c</span>( <span class="st">&quot;a&quot;</span> ,  <span class="st">&quot;b&quot;</span> ,  <span class="st">&quot;c&quot;</span> )) <span class="co">#creates a new column</span>

<span class="kw">ggplot</span>(norm, <span class="kw">aes</span>(x, y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> z), <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">colour =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">alpha =</span> <span class="dv">1</span>)))</code></pre></div>
<p>legend graafiku sisse</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">z =</span> <span class="kw">c</span>( <span class="st">&quot;a&quot;</span> ,  <span class="st">&quot;b&quot;</span> ,  <span class="st">&quot;c&quot;</span> ))
base &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> z), <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>)

base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>))
base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>))</code></pre></div>
<p>legendi asukoht graafiku ümber:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>)
base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;top&quot;</span>)
base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)
base <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>) <span class="co"># the default</span></code></pre></div>
<p>eemalda legend</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> class))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
</div>
</div>
<div id="varviskaalad" class="section level2">
<h2><span class="header-section-number">7.7</span> Värviskaalad</h2>
<p>ColorBreweri skaala “Set1” on hästi nähtav värvipimedatele. colour_brewer skaalad loodi diskreetsetele muutujatele, aga nad näevad sageli head välja ka pidevate muutujate korral.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ, hwy)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> drv)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-165-1.pdf" width="672" type="application/pdf" />
<div id="varviskaalad-pidevatele-muutujatele" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Värviskaalad pidevatele muutujatele</h3>
<p>Pidevatele muutujatele töötab scale_colour_gradient() or scale_fill_gradient(). scale_colour_gradient2() võimaldab eristada näiteks positiivseid ja negatiivseid väärtusi erinevate värviskaaladega.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">z =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="ot">NA</span>, <span class="dv">5</span>))
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(x, y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> z), <span class="dt">size =</span> <span class="dv">5</span>)
p
<span class="co"># Make missing colours invisible</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">na.value =</span> <span class="ot">NA</span>)
<span class="co"># Customise on a black and white scale</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span>  <span class="st">&quot;black&quot;</span> , <span class="dt">high =</span>  <span class="st">&quot;white&quot;</span> , <span class="dt">na.value =</span>  <span class="st">&quot;red&quot;</span> )

<span class="co">#gradient between n colours</span>
p<span class="op">+</span><span class="kw">scale_color_gradientn</span>(<span class="dt">colours =</span> <span class="kw">rainbow</span>(<span class="dv">5</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Use distiller variant with continous data</span>
<span class="kw">ggplot</span>(faithfuld) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(waiting, eruptions, <span class="dt">fill =</span> density)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;Spectral&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-167-1.pdf" width="672" type="application/pdf" />
</div>
<div id="varviskaalad-faktormuutujatele" class="section level3">
<h3><span class="header-section-number">7.7.2</span> Värviskaalad faktormuutujatele</h3>
<p>Tavaline värviskaala on scale_colour_hue() ja scale_fill_hue(), mis valivad värve HCL värvirattast. Töötavad hästi kuni u 8 värvini.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ToothGrowth &lt;-<span class="st"> </span>ToothGrowth
ToothGrowth<span class="op">$</span>dose &lt;-<span class="st"> </span><span class="kw">as.factor</span>(ToothGrowth<span class="op">$</span>dose)
mtcars &lt;-<span class="st"> </span>mtcars
mtcars<span class="op">$</span>cyl &lt;-<span class="st"> </span><span class="kw">as.factor</span>(mtcars<span class="op">$</span>cyl)

<span class="co">#bp for discrete color scales</span>
bp&lt;-<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len, <span class="dt">fill=</span>dose)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()
bp
<span class="co">#sp for continuous scales</span>
sp&lt;-<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span>wt, <span class="dt">y=</span>mpg, <span class="dt">color=</span>cyl)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()
sp

<span class="co">#You can control the default chroma and luminance, and the range </span>
<span class="co">#of hues, with the h, c and l arguments</span>
bp <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_hue</span>(<span class="dt">l=</span><span class="dv">40</span>, <span class="dt">c=</span><span class="dv">35</span>, <span class="dt">h =</span> <span class="kw">c</span>(<span class="dv">180</span>, <span class="dv">300</span>)) <span class="co">#boxplot</span>
sp <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_hue</span>(<span class="dt">l=</span><span class="dv">40</span>, <span class="dt">c=</span><span class="dv">35</span>) <span class="co">#scatterplot</span></code></pre></div>
<p>Halli varjunditega töötab scale_fill_grey().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bp <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_grey</span>(<span class="dt">start =</span> <span class="fl">0.5</span>, <span class="dt">end =</span> <span class="dv">1</span>)</code></pre></div>
<p>Järgmine võimalus on käsitsi värve sättida</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#bp for discrete color scales</span>
bp&lt;-<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len, <span class="dt">fill=</span>dose)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()
bp
<span class="co">#sp for continuous scales</span>
sp&lt;-<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span>wt, <span class="dt">y=</span>mpg, <span class="dt">color=</span>cyl)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()
sp
bp <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>))
sp <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;#999999&quot;</span>, <span class="st">&quot;#E69F00&quot;</span>, <span class="st">&quot;#56B4E9&quot;</span>))</code></pre></div>
<p>Colour_brewer-i skaalad on loodud faktormuutujaid silams pidades</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dsamp &lt;-<span class="st"> </span>diamonds[<span class="kw">sample</span>(<span class="kw">nrow</span>(diamonds), <span class="dv">1000</span>), ]
d &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dsamp, <span class="kw">aes</span>(carat, price)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> clarity))
d <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_brewer</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-171-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Change scale label</span>
d <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_brewer</span>(<span class="st">&quot;Diamond</span><span class="ch">\n</span><span class="st">clarity&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-171-2.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select brewer palette to use, see ?scales::brewer_pal for more details</span>
d <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Greens&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-171-3.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set1&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-171-4.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># scale_fill_brewer works just the same as</span>
<span class="co"># scale_colour_brewer but for fill colours</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> price, <span class="dt">fill =</span> cut)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>, <span class="dt">binwidth =</span> <span class="dv">1000</span>)
p <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-171-5.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the order of colour can be reversed</span>
<span class="co"># the brewer scales look better on a darker background</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">direction =</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_dark</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-171-6.pdf" width="672" type="application/pdf" />
<p>Väga lahedad värviskaalad, mis eriti hästi sobivad diskreetsetele muutujatele, on wesanderson paketis. Enamus skaalasid on küll ainult 3-5 värviga. Sealt saab siiski ekstrapoleerida rohkematele värvidele (?wes_palette; ?wes_palettes).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#install.packages(&quot;wesanderson&quot;)</span>
<span class="co">#library(wesanderson)</span>

<span class="co">#bp for discrete color scales</span>
bp&lt;-<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len, <span class="dt">fill=</span>dose)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()
bp

<span class="co">#wes_palette(name, n, type = c(&quot;discrete&quot;, &quot;continuous&quot;))</span>
<span class="co">#n - the nr of colors desired, type - do you want a continious scalle?</span>
bp<span class="op">+</span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span><span class="kw">wes_palette</span>(<span class="dt">n=</span><span class="dv">3</span>, <span class="dt">name=</span><span class="st">&quot;GrandBudapest&quot;</span>))

<span class="kw">wes_palette</span>(<span class="st">&quot;Royal1&quot;</span>)
<span class="kw">wes_palette</span>(<span class="st">&quot;GrandBudapest&quot;</span>)
<span class="kw">wes_palette</span>(<span class="st">&quot;Cavalcanti&quot;</span>)
<span class="kw">wes_palette</span>(<span class="st">&quot;BottleRocket&quot;</span>)
<span class="kw">wes_palette</span>(<span class="st">&quot;Darjeeling&quot;</span>)

wes_palettes <span class="co">#gives the complete list of palettes</span></code></pre></div>
<p>Argument <strong>breaks</strong> kontrollib legendi. Sama kehtib ka teiste scale_xx() funktsioonide kohta.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bp&lt;-<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len, <span class="dt">fill=</span>dose)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()
bp
<span class="co"># Box plot</span>
bp <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;2&quot;</span>, <span class="st">&quot;1&quot;</span>, <span class="st">&quot;0.5&quot;</span>), 
                       <span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>))
<span class="co"># Scatter plot</span>
<span class="co">#sp + scale_color_manual(breaks = c(&quot;8&quot;, &quot;6&quot;, &quot;4&quot;),</span>
<span class="co">#                        values=c(&quot;red&quot;, &quot;blue&quot;, &quot;green&quot;))</span>


<span class="co"># color palettes</span>
bp <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette=</span><span class="st">&quot;Dark2&quot;</span>) 
<span class="co">#sp + scale_color_brewer(palette=&quot;Dark2&quot;) </span>

<span class="co">#use graysacle</span>
<span class="co">#Change the gray value at the low and the high ends of the palette :</span>
bp <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_grey</span>(<span class="dt">start=</span><span class="fl">0.8</span>, <span class="dt">end=</span><span class="fl">0.2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>() 
<span class="co">#sp + scale_color_grey(start=0.8, end=0.2) + theme_classic() </span></code></pre></div>
<p>The ColorBrewer scales are documented online at <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org/</a> and made available in R via the RColorBrewer package. When you have a predefined mapping between values and colours, use scale_colour_manual().</p>
<p>scale_colour_manual(values = c(factor_level_1 = “red”, factor_level_2 = “blue”)</p>
<p>scale_colour_viridis() provided by the viridis package is a continuous analog of the categorical ColorBrewer scales.</p>
</div>
</div>
<div id="a-complex-ggplot" class="section level2">
<h2><span class="header-section-number">7.8</span> A complex ggplot</h2>
<p>Let’s pretend that we are measuring the same quantity by immunoassay at baseline and after 1 year of storage at -80 degrees. We’ll add some heteroscedastic error and create some apparent degradation of about 20%:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
<span class="kw">set.seed</span>(<span class="dv">10</span>) <span class="co">#make predictable random data</span>
baseline &lt;-<span class="st"> </span><span class="kw">rlnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">1</span>)
post &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">*</span>baseline <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="fl">0.10</span><span class="op">*</span>baseline)
my.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(baseline, post)
<span class="kw">ggplot</span>(my.data, <span class="kw">aes</span>(<span class="dt">x=</span>baseline, <span class="dt">y=</span>post)) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape=</span><span class="dv">1</span>) <span class="op">+</span><span class="st">    </span><span class="co"># Use hollow circles</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm) <span class="op">+</span><span class="st">  </span><span class="co"># Add linear regression line </span>
<span class="st">    </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">2</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-174-1.pdf" width="672" type="application/pdf" />
<p>Now we will prepare the difference data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diff &lt;-<span class="st"> </span>(post <span class="op">-</span><span class="st"> </span>baseline)
diffp &lt;-<span class="st"> </span>(post <span class="op">-</span><span class="st"> </span>baseline)<span class="op">/</span>baseline<span class="op">*</span><span class="dv">100</span>
sd.diff &lt;-<span class="st"> </span><span class="kw">sd</span>(diff)
sd.diffp &lt;-<span class="st"> </span><span class="kw">sd</span>(diffp)
my.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(baseline, post, diff, diffp)</code></pre></div>
<p>In standard Bland Altman plots, one plots the difference between methods against the average of the methods, but in this case, the x-axis should be the baseline result, because that is the closest thing we have to the truth.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggExtra)
diffplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(my.data, <span class="kw">aes</span>(baseline, diff)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">colour =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="co">#when the +/- 2SD lines will fall outside the default plot limits </span>
<span class="st">  </span><span class="co">#they need to be pre-stated explicitly to make the histogram line up properly. </span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="kw">mean</span>(my.data<span class="op">$</span>diff) <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>sd.diff, <span class="kw">mean</span>(my.data<span class="op">$</span>diff) <span class="op">+</span><span class="st"> </span><span class="dv">3</span><span class="op">*</span>sd.diff) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(my.data<span class="op">$</span>diff)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(my.data<span class="op">$</span>diff) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>sd.diff, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(my.data<span class="op">$</span>diff) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>sd.diff, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Difference pre and post Storage (mg/L)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Baseline Concentration (mg/L)&quot;</span>)
 
<span class="co">#And now for the magic - we&#39;ll use 25 bins</span>
<span class="kw">ggMarginal</span>(diffplot, <span class="dt">type=</span><span class="st">&quot;histogram&quot;</span>, <span class="dt">bins =</span> <span class="dv">25</span>)</code></pre></div>
<p>We can also obviously do the percent difference.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diffplotp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(my.data, <span class="kw">aes</span>(baseline, diffp)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">2</span>, <span class="dt">colour =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(my.data<span class="op">$</span>diffp)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(my.data<span class="op">$</span>diffp) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>sd.diffp, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(my.data<span class="op">$</span>diffp) <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>sd.diffp, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Difference pre and post Storage (%)&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Baseline Concentration (mg/L)&quot;</span>)


<span class="kw">ggMarginal</span>(diffplotp, <span class="dt">type=</span><span class="st">&quot;histogram&quot;</span>, <span class="dt">bins =</span> <span class="dv">25</span>)</code></pre></div>
</div>
<div id="erinevad-ggplot-geom_-id" class="section level2">
<h2><span class="header-section-number">7.9</span> Erinevad ggplot geom_-id</h2>
<div id="kui-iga-muutja-kohta-on-uks-andmepunkt" class="section level3">
<h3><span class="header-section-number">7.9.1</span> Kui iga muutja kohta on üks andmepunkt</h3>
<p>Siis kasuta cleveland graafikut. See on parem kui barplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dd &lt;-<span class="st"> </span>diamonds <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(clarity) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">number_of_diamonds=</span><span class="kw">n</span>())
dd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>number_of_diamonds, 
                  <span class="dt">y=</span><span class="kw">reorder</span>(clarity, number_of_diamonds))) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.grid.minor.x =</span> <span class="kw">element_blank</span>(),
        <span class="dt">panel.grid.major.y =</span> <span class="kw">element_line</span>(<span class="dt">colour=</span><span class="st">&quot;grey60&quot;</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;clarity&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-178-1.pdf" width="384" type="application/pdf" />
</div>
<div id="tulpdiagrammid-moodavad-counte-ja-proportsioone" class="section level3">
<h3><span class="header-section-number">7.9.2</span> Tulpdiagrammid mõõdavad counte ja proportsioone</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(diamonds)</code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    53940 obs. of  10 variables:
##  $ carat  : num  0.23 0.21 0.23 0.29 0.31 0.24 0.24 0.26 0.22 0.23 ...
##  $ cut    : Ord.factor w/ 5 levels &quot;Fair&quot;&lt;&quot;Good&quot;&lt;..: 5 4 2 4 2 3 3 3 1 3 ...
##  $ color  : Ord.factor w/ 7 levels &quot;D&quot;&lt;&quot;E&quot;&lt;&quot;F&quot;&lt;&quot;G&quot;&lt;..: 2 2 2 6 7 7 6 5 2 5 ...
##  $ clarity: Ord.factor w/ 8 levels &quot;I1&quot;&lt;&quot;SI2&quot;&lt;&quot;SI1&quot;&lt;..: 2 3 5 4 2 6 7 3 4 5 ...
##  $ depth  : num  61.5 59.8 56.9 62.4 63.3 62.8 62.3 61.9 65.1 59.4 ...
##  $ table  : num  55 61 65 58 58 57 57 55 61 61 ...
##  $ price  : int  326 326 327 334 335 336 336 337 337 338 ...
##  $ x      : num  3.95 3.89 4.05 4.2 4.34 3.94 3.95 4.07 3.87 4 ...
##  $ y      : num  3.98 3.84 4.07 4.23 4.35 3.96 3.98 4.11 3.78 4.05 ...
##  $ z      : num  2.43 2.31 2.31 2.63 2.75 2.48 2.47 2.53 2.49 2.39 ...</code></pre>
<p>loeb üles, mitu korda esineb iga cut</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> cut)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-180-1.pdf" width="384" type="application/pdf" />
<p>Pane tähele, et y-teljel on arv, mitu korda esineb tabelis iga cut. See arv ei ole tabelis muutuja. geom_bar, geom_hist, geom_dens arvutavad plotile uued y väärtused — nad jagavad andmed binidesse ja loevad üles, mitu andmepunkti sattus igasse bini.</p>
<p>Kui tahad tulpdiagrammi proportsioonidest, mitu korda eineb tabelis igat cut-i, siis tee nii:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">y =</span> ..prop.., <span class="dt">group =</span> <span class="dv">1</span>))</code></pre></div>
<p>Pane tähele et tulpade omavahelised suhted jäid samaks. Muutus ainult y-telje tähistus.</p>
<p>Edasi lisame eelnevale veel ühe muutuja: clarity. Nii saame üles lugeda kõigi cut-i ja clarity kombinatsioonide esinemise arvu või sageduse. Erinvate clarity tasemete esinemiste arv samal cut-i tasemel on siin üksteise otsa kuhjatud, mis tähendab, et tulpade kõrgus ei muutu võrreldes eelnevaga.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity))</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-182-1.pdf" width="384" type="application/pdf" />
<p>Kui me tahame, et cut-i ja clarity kombinatsioonid oleks kastidena ükteise sees, pigem kui üksteise otsa kuhjatud, siis kasutame position = “identity” argumenti.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">position =</span> <span class="st">&quot;identity&quot;</span>) </code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-183-1.pdf" width="384" type="application/pdf" />
<p>ka see graafik pole väga lihtne lugeda. Parem viime clarity klassid üksteise kõrvale</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-184-1.pdf" width="384" type="application/pdf" />
<p>Eelnev on hea viis kuidas võrrelda clarity tasemete esinemis-sagedusi ühe cut-i taseme piires.</p>
<p>Ja lõpuks, position=“fill” normaliseerib tulbad, mis muudab selle, mis toimub iga cut-i sees, hästi võrreldavaks. See on hea viis, kuidas võrrelda clarity tasemete proportsioone erinevate cut-i tasemete vahel.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> diamonds, <span class="kw">aes</span>(<span class="dt">x =</span> cut, <span class="dt">fill =</span> clarity)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-185-1.pdf" width="384" type="application/pdf" />
<p>Ja lõpuks, kui te tahate teha midagi, mis on enamasti keskmiselt rumal valik, ehk plottida tulpdiagrammi viisil, et tulba kõrgus vastaks tabeli ühes lahtris olevale numbrile, mitte faktortunnuse esinemiste arvule tabelis, siis kasutage: <code>geom_bar(stat = &quot;identity&quot;)</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="fl">2.3</span>, <span class="dv">4</span>, <span class="fl">5.2</span>), <span class="dt">b=</span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(b, a)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-186-1.pdf" width="288" type="application/pdf" />
</div>
<div id="andmepunktid-on-ukshaaval-valja-plotitud" class="section level3">
<h3><span class="header-section-number">7.9.3</span> Andmepunktid on ükshaaval välja plotitud</h3>
<p>Kõigepealt dotplot, mis ei pane andmepunkti y skaalal täpselt õigesse kohta vaid tekitab histogrammilaadsed andmebinnid, kus siiski iga punkt on eraldi näidatud. See lihtsustab veidi “kirjude” kompleksete andemsettide esitust.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ToothGrowth &lt;-<span class="st"> </span>ToothGrowth
ToothGrowth<span class="op">$</span>dose &lt;-<span class="st"> </span><span class="kw">as.factor</span>(ToothGrowth<span class="op">$</span>dose)
p&lt;-<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>, <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>)
p</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-187-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Change dotsize and stack ratio, add line or dot for median</span>
<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>, <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>,
               <span class="dt">stackratio=</span><span class="fl">1.5</span>, <span class="dt">dotsize=</span><span class="fl">0.7</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> median, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">shape =</span> <span class="dv">95</span>, 
               <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">15</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_tufte</span>()</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-187-2.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>median, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">shape=</span><span class="dv">18</span>,
                 <span class="dt">size=</span><span class="dv">5</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-187-3.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#add mean and SD, use pointrange</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.data=</span>mean_sdl, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">mult=</span><span class="dv">1</span>), 
                 <span class="dt">geom=</span><span class="st">&quot;pointrange&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Computation failed in `stat_summary()`:
## Hmisc package required for this function</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-187-4.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#use errorbars</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">stat_summary</span>(<span class="dt">fun.data=</span>mean_sdl, <span class="dt">fun.args =</span> <span class="kw">list</span>(<span class="dt">mult=</span><span class="dv">1</span>), 
        <span class="dt">geom=</span><span class="st">&quot;errorbar&quot;</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">width=</span><span class="fl">0.2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Computation failed in `stat_summary()`:
## Hmisc package required for this function</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-187-5.pdf" width="672" type="application/pdf" />
<p>Sama jitterplotina — nüüd on iga punkt y suhtes õiges kohas, aga joonis ei näe enam liiga puhas välja.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.05</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> median, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">shape =</span> <span class="dv">95</span>, 
               <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">15</span>, <span class="dt">alpha=</span><span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_tufte</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-188-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Change dot plot colors by groups</span>
p&lt;-<span class="kw">ggplot</span>(ToothGrowth, <span class="kw">aes</span>(<span class="dt">x=</span>dose, <span class="dt">y=</span>len, <span class="dt">fill=</span>dose)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>, <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>)
p</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-189-1.pdf" width="672" type="application/pdf" />
<p>It is also possible to change manually dot plot colors using the functions :</p>
<p>scale_fill_manual() : to use custom colors</p>
<p>scale_fill_brewer() : to use color palettes from RColorBrewer package</p>
<p>scale_fill_grey() : to use grey color palettes</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Choose which items to display :</span>
p <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_discrete</span>(<span class="dt">limits=</span><span class="kw">c</span>(<span class="st">&quot;0.5&quot;</span>, <span class="st">&quot;2&quot;</span>))</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<pre><code>## Warning: Removed 20 rows containing non-finite values
## (stat_bindot).</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-190-1.pdf" width="672" type="application/pdf" />
<p>Dotplot kui histogram:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_dotplot</span>()</code></pre></div>
<pre><code>## `stat_bindot()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-191-1.pdf" width="672" type="application/pdf" />
<p>Histogram:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Sepal.Length)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;navyblue&quot;</span>) </code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-192-1.pdf" width="672" type="application/pdf" />
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggthemes)
d &lt;-<span class="st"> </span>iris        <span class="co"># Full data set</span>
d_bg &lt;-<span class="st"> </span>d[, <span class="op">-</span><span class="dv">5</span>]  <span class="co"># Background Data - full without the 5th column (Species)</span>

<span class="kw">ggplot</span>(<span class="dt">data =</span> d, <span class="kw">aes</span>(<span class="dt">x =</span> Sepal.Width, <span class="dt">fill =</span> Species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> d_bg, <span class="dt">fill =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.8</span>, <span class="dt">bins=</span><span class="dv">10</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">bins=</span><span class="dv">10</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(Species<span class="op">~</span>.) <span class="op">+</span>
<span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st">  </span><span class="co"># to remove the legend</span>
<span class="st">  </span><span class="kw">theme_tufte</span>()          <span class="co"># for clean look overall</span></code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-193-1.pdf" width="672" type="application/pdf" />
<p>density plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris<span class="op">%&gt;%</span><span class="kw">ggplot</span>()<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(Sepal.Width, <span class="dt">fill=</span>Species, <span class="dt">color=</span>Species, <span class="dt">alpha=</span><span class="fl">0.5</span>))<span class="op">+</span>
<span class="st">  </span><span class="kw">theme_tufte</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-194-1.pdf" width="672" type="application/pdf" />
<p>joyplot võimaldab kõrvuti panna isegi sadu density plotte</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggjoy)
<span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Species, <span class="dt">fill=</span>Species)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_joy</span>(<span class="dt">scale=</span><span class="dv">4</span>, <span class="dt">rel_min_height=</span><span class="fl">0.01</span>, <span class="dt">alpha=</span><span class="fl">0.9</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_joy</span>(<span class="dt">font_size =</span> <span class="dv">13</span>, <span class="dt">grid=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</code></pre></div>
<pre><code>## Picking joint bandwidth of 0.181</code></pre>
<embed src="main_files/figure-html/unnamed-chunk-195-1.pdf" width="672" type="application/pdf" />
<p>Joyplot, kui meil on väga palju kõrvuti tihedusjaotusi võrrelda</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sch &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/schools.csv&quot;</span>)
sch<span class="op">$</span>school &lt;-<span class="st"> </span><span class="kw">as.factor</span>(sch<span class="op">$</span>school)
<span class="kw">ggplot</span>(sch, <span class="kw">aes</span>(score1, <span class="dt">y=</span><span class="kw">reorder</span>(school, score1))) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_joy</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_tufte</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-196-1.pdf" width="672" type="application/pdf" />
<p>Boxplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Species, Sepal.Width, <span class="dt">fill=</span>Species)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-197-1.pdf" width="672" type="application/pdf" />
<p>violin plot plus jitterplot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(Species, Sepal.Width)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>Species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">alpha=</span><span class="fl">0.4</span>, <span class="dt">size=</span><span class="fl">0.5</span>)</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-198-1.pdf" width="672" type="application/pdf" />
</div>
<div id="kahe-muutuja-koos-varieeruvus" class="section level3">
<h3><span class="header-section-number">7.9.4</span> Kahe muutuja koos-varieeruvus</h3>
<p>X-teljel on geisri Old Faithful pursete tugevus ja y-teljel pursete vaheline aeg. Kui kahe purske vahel kulub rohkem aega, siis on oodata tugevamat purset. Tundub, et see süsteem töötab kahes diskreetses reziimis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="kw">ggplot</span>(faithful, <span class="kw">aes</span>(<span class="dt">x =</span> eruptions, <span class="dt">y =</span> waiting)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlim</span>(<span class="fl">0.5</span>, <span class="dv">6</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylim</span>(<span class="dv">40</span>, <span class="dv">110</span>)
<span class="co">#m + stat_density_2d(aes(fill = ..level..), geom = &quot;polygon&quot;)</span>
m <span class="op">+</span><span class="st"> </span><span class="kw">geom_density_2d</span>()</code></pre></div>
<embed src="main_files/figure-html/unnamed-chunk-199-1.pdf" width="672" type="application/pdf" />
<p>Kui punkte on liiga palju, et välja trükkida, kasuta geom = “polygon” varianti.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="funs.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidyverse.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/lunr.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstats-tartu/lectures/edit/master/06-graphics.Rmd",
"text": "Edit"
},
"download": ["main.pdf", "main.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
